-- Financial forecast matching with fallback strategy
Create database Experiment2;
USE Experiment2; 

CREATE TABLE YEAR_TBL (
  id INTEGER PRIMARY KEY,
  year INTEGER NOT NULL,
  NPV INTEGER
);


CREATE TABLE QUERIES (
  id INTEGER NOT NULL,
  year INTEGER,
  FOREIGN KEY (id) REFERENCES YEAR_TBL(id)
);
INSERT INTO YEAR_TBL (id, year, NPV) VALUES
(1, 2020, 1000),
(2, 2021, 1200),
(3, 2022, 1400),
(4, 2023, 1600),
(5, 2025, 1800);
INSERT INTO QUERIES (id, year) VALUES
(1, 2020),
(2, 2028),
(3, 2022),
(4, 2023),
(5, 2024);

SELECT QUERIES.ID,QUERIES.YEAR,YEAR_TBL.NPV
FROM QUERIES
INNER JOIN YEAR_TBL
ON QUERIES.YEAR=YEAR_TBL.YEAR
AND 
YEAR_TBL.YEAR=QUERIES.YEAR
